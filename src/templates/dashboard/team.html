{% extends "template.html" %}

{% block body %}
<h1>Groupe "{{ team.name }}"</h1>


<h2>Nouvelle dépense en commun</h2>
<form class="pure-form pure-form-stacked" method="post" action="{{ url_for('team.add_expenditure', tid=team.id) }}">

	<div class="pure-g">
		<div class="pure-u-1 pure-u-md-1-3">
			<label>Qui a payé</label>
			<select name="who_paid" class="pure-u-23-24">
				{% for user in team.get_users() %}
					<option value="{{ user.id }}">{{ user.name }}</option>
				{% endfor %}
			</select>
		</div>

		<div class="pure-u-1 pure-u-md-1-3">
			<label>Acheté quoi ?</label>
			<input type="text" name="title" placeholder="ex. courses Carrefour" class="pure-u-23-24"> 

		</div>

		<div class="pure-u-1 pure-u-md-1-3">
			<label>Montant (€)</label>
			<input type="number" step="0.01" name="amount"  class="pure-u-23-24">
		</div>

		<div class="pure-u-1 pure-u-md-1-3">
			<label>Commentaire</label>
			<input type="text" name="comment" placeholder="(facultatif)" class="pure-u-23-24">
		</div>

		<div class="pure-u-1 pure-u-md-1-3">
			<label>&nbsp;</label>
			<input type="submit" value="Ajouter" class="pure-button pure-button-primary">
		</div>
	</div>
</form>

<br>

<h2>Dépenses en commun</h2>
<table class="pure-table">
	<thead>
		<tr>
			<th>Date</th>
			<th>Qui a payé</th>
			<th>Intitulé</th>
			<th>Montant</th>
			<th>Commentaire</th>
		</tr>
	</thead>

	{% for expenditure in team_expenditures %}

		<tr class="{{ loop.cycle('pure-table-odd', '') }}">
			<td>{{ expenditure.date }}</td>
			<td>{{ expenditure.get_user().name }}</td>
			<td>{{ expenditure.title }}</td>
			<td>{{ expenditure.amount }}</td>
			<td>{{ expenditure.comment }}</td>
		</tr>

	{% endfor %}

</table>

<br>

<h2>Comptes</h2>
<table class="pure-table">
	<thead>
		<tr>
			<th>Total payé par</th>
			<th>Montant</th>
		</tr>
	</thead>

	{% for user in team.get_users() %}

		<tr class="{{ loop.cycle('pure-table-odd', '') }}">
			<td>{{ user.name }}</td>
			<td>{{ user.get_total_spent_in_team(team.id) }} €</td>
		</tr>

	{% endfor %}

	<tr>
		<td colspan="2"><b>Total dépenses groupe : {{ team.get_total_spent() }} €</b></td>
	</tr>

</table>

<br>

<h2>À propos du groupe</h2>
<b>Description :</b> {{ team.description }}<br>
<b>Membres :</b>
<ul>
	{% for user in team.get_users() %}
		<li>{{ user.name }}</li>
	{% endfor %}
</ul>

<form class="pure-form" method="post" action="{{ url_for('team.add_user', tid=team.id) }}">
    <fieldset>
        <legend>Ajouter au groupe</legend>

        <input type="text" name="user_name" placeholder="Nom">
        <button type="submit" class="pure-button pure-button-primary">+</button>
    </fieldset>
</form>

{% endblock %}